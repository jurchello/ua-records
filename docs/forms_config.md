# UARecords ‚Äî –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —Ñ–æ—Ä–º (README, UA)

–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—É—î, —è–∫ –Ω–∞–ª–∞—à—Ç–æ–≤—É–≤–∞—Ç–∏ **—Ñ–æ—Ä–º–∏**, **–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏** —Ç–∞ **—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏** —É UARecords, –∞ —Ç–∞–∫–æ–∂ —É—Å—ñ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –æ–ø—Ü—ñ—ó –ø–æ–ª—ñ–≤, –º–µ—Ö–∞–Ω—ñ–∫—É –∫–µ—Ä—É–≤–∞–Ω–Ω—è –¥–æ–≤–∂–∏–Ω–æ—é –º—ñ—Ç–æ–∫ (label mode) —á–µ—Ä–µ–∑ —â—ñ–ª—å–Ω—ñ—Å—Ç—å (density), –ø—Ä–∞–≤–∏–ª–∞ drag‚Äëand‚Äëdrop, –ª–æ–≥—ñ–∫—É –º–∞–∫–µ—Ç–∞ —Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è GUI.

> –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∑—è—Ç—ñ –∑ —Ä–µ–∞–ª—å–Ω–∏—Ö –º–æ–¥—É–ª—ñ–≤: `BaseEditForm`, `FieldRenderer`, `FrameBuilder`, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ `landowner`, `witness`, `clergyman` —ñ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ñ–≤ `man_subject`, `woman_subject` —Ç–æ—â–æ.


## 1) –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–æ—Ä–º —ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è

### 1.1. –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ —Ñ–æ—Ä–º–∞
```python
from forms.components import COMPONENTS_REGISTRY
from forms.fragments import FRAGMENTS_REGISTRY
from utils.include import expand_form

FORM = {
    "marriage": {
        "id": "marriage",
        "title": "–§–æ—Ä–º–∞ —à–ª—é–±—É",
        "list_label": "–î–æ–¥–∞—Ç–∏ —à–ª—é–± –∑ –º–µ—Ç—Ä–∏—á–Ω–æ—ó –∫–Ω–∏–≥–∏",
        "type": "–®–ª—é–±",
        # –Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ: "columns": 3 (–∫—ñ–ª—å–∫—ñ—Å—Ç—å ¬´–ø–∞—Ä¬ª –º—ñ—Ç–∫–∞+–∫–æ–Ω—Ç—Ä–æ–ª —É —Ñ—Ä–µ–π–º—ñ)
        "tabs": [
            {
                "id": "common_box",
                "titles": {"short": "üóÇÔ∏è", "middle": "–ó–∞–≥–∞–ª.", "long": "–ó–∞–≥–∞–ª—å–Ω–µ", "default": "–ó–∞–≥–∞–ª—å–Ω–µ"},
                "frames": [{
                    "title": "–ó–∞–≥–∞–ª—å–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏",
                    "fields": [
                        {"id": "common_box.citation", "label": "–¶–∏—Ç–∞—Ç–∞", "type": "citation", "default": "C12345"},
                        {"id": "common_box.marriage_place", "label": "–ú—ñ—Å—Ü–µ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó —à–ª—é–±—É", "type": "place", "default": "P00001"},
                        {"id": "common_box.tags_for_new_people", "label": "–¢–µ–≥–∏ –¥–ª—è –Ω–æ–≤–∏—Ö –ø–µ—Ä—Å–æ–Ω", "type": "entry", "span_rest": True},
                    ],
                }],
            },
        ],
    }
}

# –í–ê–ñ–õ–ò–í–û: –ü–µ—Ä–µ–¥ —Ä–µ–Ω–¥–µ—Ä–æ–º —Ä–æ–±–∏–º–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è $include —Ç–∞ $fragment
FORM_EXPANDED = expand_form(FORM, COMPONENTS_REGISTRY, FRAGMENTS_REGISTRY)
```
- `tabs[].titles` ‚Äî —Å–ª–æ–≤–Ω–∏–∫ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ –≤–∫–ª–∞–¥–∫–∏ –∑–∞ —Ä–µ–∂–∏–º–æ–º –º—ñ—Ç–æ–∫: `short | middle | long` (—ñ –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ `default`).  
  **BaseEditForm** –ø—ñ–¥ —á–∞—Å –ø–æ–±—É–¥–æ–≤–∏ –ø—ñ–¥—Å—Ç–∞–≤–ª—è—î –Ω–∞–∑–≤—É –≤–∫–ª–∞–¥–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –ø–æ—Ç–æ—á–Ω–æ–≥–æ `label_mode`.

### 1.2. –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è `$include` —Ç–∞ `$fragment`
- **$include** ‚Äî –ø—ñ–¥–∫–ª—é—á–∞—î **–∫–æ–º–ø–æ–Ω–µ–Ω—Ç** –∑–∞ –∫–ª—é—á–µ–º `component`, –º–æ–Ω—Ç—É—î –π–æ–≥–æ —É –≤–∫–∞–∑–∞–Ω–∏–π —à–ª—è—Ö `mount` —ñ –º–æ–∂–µ –∑–∞–¥–∞—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–∏–π `"title"`:
```jsonc
{ "$include": { "component": "witness", "mount": "groom_box.witness_box_1", "title": "1. –ü–æ—Ä—É—á–∏—Ç–µ–ª—å –Ω–∞—Ä–µ—á–µ–Ω–æ–≥–æ" } }
```
- **$fragment** ‚Äî –≤–º–æ–Ω—Ç–æ–≤—É—î **—Ñ—Ä–∞–≥–º–µ–Ω—Ç** (–Ω–∞–±—ñ—Ä –ª–æ–∫–∞–ª—å–Ω–∏—Ö –ø–æ–ª—ñ–≤ –±–µ–∑ –ø—Ä–µ—Ñ—ñ–∫—Å—ñ–≤), –¥–æ–¥–∞—î –¥–æ –∫–æ–∂–Ω–æ–≥–æ –ø–æ–ª—è `mount` —É –π–æ–≥–æ `id`:
```jsonc
{"$fragment": {"fragment": "man_subject", "mount": "groom_box.subject_person"}}
```

–ü—ñ—Å–ª—è `expand_form(...)` –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ –ø–æ–≤–Ω–∏–π, ¬´–ø–ª–∞—Å–∫–∏–π¬ª –æ–ø–∏—Å —Ñ–æ—Ä–º–∏ –±–µ–∑ `$include`/`$fragment` ‚Äî —Å–∞–º–µ –π–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å GUI.


## 2) –í–∫–ª–∞–¥–∫–∏ (tabs) —ñ –∑–º—ñ–Ω–∞ –¥–æ–≤–∂–∏–Ω–∏ –º—ñ—Ç–æ–∫ (label mode)

### 2.1. –ú–æ–¥–µ–ª—å **Label Mode**
- –î–∂–µ—Ä–µ–ª–æ –ø—Ä–∞–≤–¥–∏: `configs.constants.get_label_mode()` ‚Üí –ø–æ–≤–µ—Ä—Ç–∞—î `"short" | "middle" | "long"`.
- –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –∑ —â—ñ–ª—å–Ω—ñ—Å—Ç—é: `sync_label_mode_from_density()` –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –º–∞–ø–∏—Ç—å:
  - `compact ‚Üí short`
  - `normal ‚Üí middle`
  - `spacious ‚Üí long`

### 2.2. –û–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–∞–∑–≤ –≤–∫–ª–∞–¥–æ–∫
- –ü—ñ–¥–ø–∏—Å–∫–∞ –≤—ñ–∫–Ω–∞ —Ñ–æ—Ä–º–∏ –Ω–∞ –∑–º—ñ–Ω—É —Ä–µ–∂–∏–º—É:
  ```python
  self._label_mode_sub = subscribe_label_mode(self._on_label_mode_changed)
  ```
- –ù–∞ –ø–æ–¥—ñ—é ‚Äî –æ–Ω–æ–≤–ª—é—î–º–æ –≤—Å—ñ —Ç–∞–±–∏:
  ```python
  def _on_label_mode_changed(self, _mode: str) -> None:
      self._update_tab_titles(0)
      if self._notebook:
          self._notebook.queue_draw()
  ```
- –õ–æ–≥—ñ–∫–∞ –≤–∏–±–æ—Ä—É –ø—ñ–¥–ø–∏—Å—É:
  ```python
  titles = tab_config.get("titles", {})
  text = titles.get(get_label_mode()) or titles.get("default") or base_text
  label.set_markup(GLib.markup_escape_text(text))
  label.set_tooltip_text(titles.get("long") or titles.get("default") or base_text)
  ```

> **–ü–æ—Ä–∞–¥–∞.** –©–æ–± —É—Å–µ –ø—Ä–∞—Ü—é–≤–∞–ª–æ –¥–∏–Ω–∞–º—ñ—á–Ω–æ, —Ç—Ä–∏–º–∞–π—Ç–µ –∫–ª—é—á—ñ –≤–∫–ª–∞–¥–æ–∫ —Å–∞–º–µ —è–∫ `short/middle/long`, –∞ –Ω–µ `1/2`.


## 3) –§—Ä–µ–π–º–∏ (frames) —Ç–∞ –ø–æ–ª—è (fields)

### 3.1. –§—Ä–µ–π–º
```jsonc
{
  "title": "–ù–∞—Ä–µ—á–µ–Ω–∞",
  "prefix": "...",
  "background_color": "Gdk.RGBA(0.98, 0.94, 0.85, 0.3)", // –æ–ø—Ü.
  "fields": [ /* –¥–∏–≤. –Ω–∏–∂—á–µ */ ]
}
```
`FrameBuilder` –∑–∞—Å—Ç–æ—Å–æ–≤—É—î –≤—ñ–¥—Å—Ç—É–ø–∏/—Ä–∞–º–∫–∏ –∑ `density`. –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ñ—Ä–µ–π–º–∞ —Å—Ç–∞–≤–∏—Ç—å—Å—è —è–∫ `Gtk.Frame` label.

### 3.2. –¢–∏–ø–∏ –ø–æ–ª—ñ–≤
–ü—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å—Å—è —Ç–∏–ø–∏:  
- `"entry"` ‚Äî —Ç–µ–∫—Å—Ç–æ–≤–µ –ø–æ–ª–µ –∑ –ø—ñ–¥–∫–∞–∑–∫–∞–º–∏ (EntryCompletion) –∞–±–æ –∫–æ–º–±–æ–±–æ–∫—Å–æ–º, —è–∫—â–æ `use_combobox=True`.  
- `"person"`, `"place"`, `"citation"` ‚Äî DnD‚Äë–ª—ñ–Ω–∫–∏ –Ω–∞ –æ–±‚Äô—î–∫—Ç–∏ –ë–î (–ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è –∑ –¥–µ—Ä–µ–≤–∞ Gramps).  
- `"check"` / `"checkbox"` ‚Äî –ª–æ–≥—ñ—á–Ω—ñ –ø—Ä–∞–ø–æ—Ä—Ü—ñ; –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ **inline** –µ—Ç–∏–∫–µ—Ç–∫—É —á–µ—Ä–µ–∑ `inline_label=True`.  
- `"spacer"` ‚Äî –ø–æ—Ä–æ–∂–Ω—ñ–π –ø—Ä–æ—Å—Ç—ñ—Ä –¥–ª—è –≤–∏—Ä—ñ–≤–Ω—é–≤–∞–Ω–Ω—è.

### 3.3. –ö–ª—é—á—ñ –ø–æ–ª—ñ–≤ (–ø–æ–≤–Ω–∏–π —Å–ø–∏—Å–æ–∫)
```jsonc
{
  "id": "bride_box.subject_person.original_name",   // –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π ID (–ø—ñ—Å–ª—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è $fragment/$include)
  "type": "entry" | "person" | "place" | "citation" | "check" | "checkbox" | "spacer",

  // –¢–ï–ö–°–¢/–ú–Ü–¢–ö–ò
  "label": "–Ü–º'—è (–æ—Ä–∏–≥—ñ–Ω–∞–ª)",                       // fallback, —è–∫—â–æ –Ω–µ–º–∞—î "labels"
  "labels": {                                       // –∞–¥–∞–ø—Ç–∏–≤–Ω—ñ –º—ñ—Ç–∫–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è)
    "long": "–Ü–º'—è (–Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–µ)",
    "middle": "–Ü–º'—è (–Ω–æ—Ä–º–∞–ª—ñ–∑.)",
    "short": "–Ü–º'—è (–Ω.)",
    "default": "–Ü–º'—è"                               // –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ
  },
  "tooltip": "–ü–æ—è—Å–Ω–µ–Ω–Ω—è"                             // –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è checkbox inline —ñ DnD-–ª—ñ–Ω–∫—ñ–≤

  // –í–ò–ü–ê–î–ö–ò –î–õ–Ø entry
  "options": ["...", "..."] | some_lookup,          // –æ–ø—Ü.: —Å–ª–æ–≤–Ω–∏–∫/–ø—Ä–æ–≤–∞–π–¥–µ—Ä –ø—ñ–¥–∫–∞–∑–æ–∫
  "use_combobox": true,                              // –æ–ø—Ü.: –∑–∞–º—ñ—Å—Ç—å entry –∑ completion ‚Äî –≤–∏–ø–∞–¥–∞—é—á–∏–π —Å–ø–∏—Å–æ–∫

  // –ó–ù–ê–ß–ï–ù–ù–Ø –ó–ê–ú–û–í–ß–£–í–ê–ù–ù–Ø
  "default": "–∑–Ω–∞—á–µ–Ω–Ω—è",                             // –¥–ª—è entry/combobox –∞–±–æ handle/gramps_id –¥–ª—è DnD

  // –ú–ê–ö–ï–¢ / –†–û–ó–¢–ê–®–£–í–ê–ù–ù–Ø
  "order": { "1": 1, "2": 1, "3": 1, "default": 1 } // –ø–æ–∑–∏—Ü—ñ—è –≤ –º–µ–∂–∞—Ö —Ñ—Ä–µ–π–º–∞ (–¥–∏–≤. ¬ß4)
           | "c1.o1, c2.o1, c3.o2",                 // –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π —Ä—è–¥–∫–æ–≤–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
  "span_rest": true,                                 // –∑–∞–π–Ω—è—Ç–∏ –≤–µ—Å—å –∑–∞–ª–∏—à–æ–∫ —Ä—è–¥—É (–∫–æ–Ω—Ç—Ä–æ–ª —Ä–æ–∑—Ç—è–≥–Ω–µ—Ç—å—Å—è)
  "span_pairs": 2 | { "default": 1, "3": 2 },        // –∑–∞–π–Ω—è—Ç–∏ N ¬´–ø–∞—Ä¬ª –º—ñ—Ç–∫–∞+–∫–æ–Ω—Ç—Ä–æ–ª (–¥–∏–≤. ¬ß4.2)
  "show_when_cols_in": [3,4,5],                      // –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –ø—Ä–∏ —Ç–∞–∫–∏—Ö –∫—ñ–ª—å–∫–æ—Å—Ç—è—Ö –∫–æ–ª–æ–Ω–æ–∫

  // –£–ú–û–í–ù–ï –í–Ü–î–û–ë–†–ê–ñ–ï–ù–ù–Ø –ó–ê –°–¢–ê–ù–û–ú
  "show_when": { "var": "{mount}.gender", "equals": "–ñ—ñ–Ω–∫–∞" }
             | { "var": "{mount}.gender", "in": ["–ß–æ–ª–æ–≤—ñ–∫","–ñ—ñ–Ω–∫–∞"] },

  // –ú–ê–ü–Ü–ù–ì –°–¢–ê–ù–£
  "state_key": "{mount}.military_rank",              // –∫—ñ–ª—å–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª—ñ–≤ –ø–∏—à—É—Ç—å —É —Å–ø—ñ–ª—å–Ω–∏–π –∫–ª—é—á state

  // SPACER
  "row_height": 6                                    // –≤–∏—Å–æ—Ç–∞ –ø–æ—Ä–æ–∂–Ω—å–æ–≥–æ —Ä—è–¥–∫–∞/–ø—Ä–æ–∫–ª–∞–¥–∫–∏
}
```

#### 3.3.1. –ú—ñ—Ç–∫–∏ (`labels`) —ñ –ø—ñ–¥–∫–∞–∑–∫–∏
`FieldRenderer._label_for_field` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `labels[mode]` –¥–µ `mode = get_label_mode()`.  
Tooltip –¥–ª—è –ø–æ–ª—è (–¥–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ) –±–µ—Ä–µ—Ç—å—Å—è –∑ `labels["long"]` –∞–±–æ `labels["default"]` (—è–∫ fallback).

#### 3.3.2. DnD‚Äë–ø–æ–ª—è (`person/place/citation`)
- –ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Ç–µ–∫—Å—Ç –±–µ—Ä–µ—Ç—å—Å—è –∑ –ø—Ä–∞–≤–∏–ª `get_dnd_rules()` (–¥–∏–≤. ¬ß5).
- –Ø–∫—â–æ –∑–∞–¥–∞–Ω–∏–π `"default"` —è–∫ **Gramps ID**, –≤—ñ–Ω –±—É–¥–µ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏–π —É –Ω–∞–∑–≤—É –æ–±‚Äô—î–∫—Ç–∞.
- –ö–Ω–æ–ø–∫–∞ ‚úï –æ—á–∏—â–∞—î –≤–∏–±—ñ—Ä; –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è –º–æ–∂–ª–∏–≤–µ –∑–∞ ¬´grip¬ª (—Å–∏–º–≤–æ–ª `‚à∑`).

#### 3.3.3. Checkbox
- `inline_label=True` ‚Äî –ø—ñ–¥–ø–∏—Å –ø—Ä–∞–≤–æ—Ä—É—á —É—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–Ω–æ–ø–∫–∏ (–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –ø–µ—Ä–µ–Ω–æ—Å–æ–º).
- `max_label_chars` ‚Äî –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–∞ –º–µ–∂–∞ –¥–ª—è —à–∏—Ä–∏–Ω–∏ inline‚Äë—Ç–µ–∫—Å—Ç—É.


## 4) –ú–∞–∫–µ—Ç —ñ –≤–ø–ª–∏–≤ `columns`

### 4.1. `columns` (frame_pairs)
–§—Ä–µ–π–º –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –ø–æ–ª—è –≤ **N –ø–∞—Ä–∞—Ö** (N = `columns`) ‚Äî –∫–æ–∂–Ω–∞ –ø–∞—Ä–∞: **label + widget**.  
–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –±–µ—Ä–µ—Ç—å—Å—è `form_config["columns"]` (—è–∫—â–æ —î) –∞–±–æ `3` —É `BaseEditForm`.

### 4.2. `order` —ñ —Ä–æ–∑–∫–ª–∞–¥–∫–∞
–ü–æ–ª–µ –º–∞—î **–∫–ª—é—á —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è** —É –º–µ–∂–∞—Ö —Å–≤–æ–≥–æ —Ñ—Ä–µ–π–º–∞:
- –í–∞—Ä—ñ–∞–Ω—Ç 1 ‚Äî —Å–ª–æ–≤–Ω–∏–∫:
  ```json
  "order": { "1": 1, "2": 1, "3": 2, "default": 10 }
  ```
  –¥–µ –∫–ª—é—á ‚Äî –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–∞—Ä —É —Ñ—Ä–µ–π–º—ñ (`columns`), –∑–Ω–∞—á–µ–Ω–Ω—è ‚Äî –ø–æ–∑–∏—Ü—ñ—è.
- –í–∞—Ä—ñ–∞–Ω—Ç 2 ‚Äî —Ä—è–¥–æ–∫: `"c1.o1, c2.o1, c3.o2"` (cN.oM ‚á¢ –¥–ª—è N –∫–æ–ª–æ–Ω–æ–∫ ‚Äî –ø–æ—Ä—è–¥–æ–∫ M).
- –Ø–∫—â–æ `order` –Ω–µ –∑–∞–¥–∞–Ω–æ ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **–ø–æ—Ä—è–¥–æ–∫ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è** (–≤ –∫–æ–Ω—Ñ—ñ–≥—É).

### 4.3. –†–æ–∑—Ç—è–≥—É–≤–∞–Ω–Ω—è (`span_rest` / `span_pairs`)
- `span_rest: true` ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª –∑–∞–π–º–µ –≤–µ—Å—å **–∑–∞–ª–∏—à–æ–∫** –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Ä—è–¥–∫–∞ (–µ—Ç–∏–∫–µ—Ç–∫–∞ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –≤ —Å–≤–æ—ó–π –∫–ª—ñ—Ç–∏–Ω—Ü—ñ).
- `span_pairs: N` ‚Äî –∑–∞–π–º–µ **N –ø–∞—Ä**. –ú–æ–∂–Ω–∞ –∑–∞–¥–∞–≤–∞—Ç–∏ –æ–∫—Ä–µ–º–æ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö `columns`:
  ```json
  "span_pairs": { "default": 1, "3": 2 }
  ```

### 4.4. –ê–¥–∞–ø—Ç–∞—Ü—ñ—è –ø—Ä–∏ –∑–º—ñ–Ω—ñ `columns`
–ü—Ä–∏ –∑–º—ñ–Ω—ñ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–ª–æ–Ω–æ–∫ (–≤ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö –ø–ª–∞–≥—ñ–Ω–∞) —Ñ–æ—Ä–º–∞ –ø–µ—Ä–µ–≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è (`_refresh_open_forms`), —Ä–æ–∑–∫–ª–∞–¥–∫–∞ –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è, –∞ –ø–æ–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º `show_when_cols_in`, `order` —Ç–∞ `span_*`.


## 5) DnD ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ñ–≤ —ñ —à–∏—Ä–∏–Ω

–ù–∞–ª–∞—à—Ç–æ–≤—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü—ñ—ó –≤ `configs.constants`:
```python
def get_dnd_rules() -> list[dict]:
    return [
        {
            "match": {"field_id": {"endswith": "person_owner"}},
            "placeholder": "–ü–µ—Ä–µ—Ç—è–≥–Ω–∏ –ø–æ–º—ñ—â–∏–∫–∞ —Å—é–¥–∏...",
            "width": get_person_name_length(),
        },
        {
            "match": {"field_type": {"equals": "person"}},
            "placeholder": "–ü–µ—Ä–µ—Ç—è–≥–Ω–∏ –æ—Å–æ–±—É —Å—é–¥–∏...",
            "width": get_person_name_length(),
        },
        {
            "match": {"field_type": {"equals": "place"}},
            "placeholder": "–ü–µ—Ä–µ—Ç—è–≥–Ω–∏ –º—ñ—Å—Ü–µ —Å—é–¥–∏...",
            "width": get_place_title_length(),
        },
        {
            "match": {"field_type": {"equals": "citation"}},
            "placeholder": "–ü–µ—Ä–µ—Ç—è–≥–Ω–∏ —Ü–∏—Ç–∞—Ç—É —Å—é–¥–∏...",
            "width": get_citation_text_length(),
        },
    ]
```
- `match` –º–æ–∂–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ `field_id` (`equals`/`startswith`/`endswith`) —Ç–∞/–∞–±–æ `field_type`.
- –Ø–∫—â–æ –∂–æ–¥–Ω–µ –ø—Ä–∞–≤–∏–ª–æ –Ω–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `get_dnd_default()`.

–ö–æ–ª—å–æ—Ä–∏ DnD/entry –ø–æ–ª—ñ–≤:
```python
COLOR_EMPTY_DND   = "#eaeaea"
COLOR_FILLED_DND  = "#dfffce"
COLOR_EMPTY_INPUT = "#ffffff"
COLOR_FILLED_INPUT= "#dfffce"
```


## 6) –©—ñ–ª—å–Ω—ñ—Å—Ç—å —Ñ–æ—Ä–º–∏ (density) —Ç–∞ —Ä–æ–∑–º—ñ—Ä–∏

–©—ñ–ª—å–Ω—ñ—Å—Ç—å –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `settings.settings_manager` (–æ–ø—Ü—ñ—è ¬´–°—Ç–∏–ª—å —Ñ–æ—Ä–º¬ª) —ñ –∑—á–∏—Ç—É—î—Ç—å—Å—è —É —Ä–∞–Ω—Ç–∞–π–º—ñ:
```python
DENSITY_SETTINGS = {
  "compact": { "grid_margin": 10, "row_grid_spacing": 3,  "grid_column_spacing": 6, ... },
  "normal":  { "grid_margin": 20, "row_grid_spacing": 10, "grid_column_spacing": 10, ... },
  "spacious":{ "grid_margin": 30, "row_grid_spacing": 15, "grid_column_spacing": 15, ... },
}
```
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ `FrameBuilder` —ñ `BaseEditForm` –¥–ª—è –ø–∞–¥—ñ–Ω–≥—ñ–≤/–≤—ñ–¥—Å—Ç—É–ø—ñ–≤/—Å–ø–µ–π—Å–∏–Ω–≥—ñ–≤.
- `sync_label_mode_from_density()` –æ–Ω–æ–≤–ª—é—î `label_mode` –∑–≥—ñ–¥–Ω–æ —â—ñ–ª—å–Ω–æ—Å—Ç—ñ.

–î–æ–≤–∂–∏–Ω–∏ —Å–∫–æ—Ä–æ—á–µ–Ω—å –¥–ª—è –ø—ñ–¥–∫–∞–∑–æ–∫/DnD –±–µ—Ä—É—Ç—å—Å—è –∑ —Ü–∏—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å:
```python
get_person_name_length()
get_place_title_length()
get_citation_text_length()
```


## 7) –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ —Ç–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏

### 7.1. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç (component)
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Äî —Ü–µ –±–∞–≥–∞—Ç–æ—Ä–∞–∑–æ–≤–∏–π –±–ª–æ–∫ —ñ–∑ –≤–ª–∞—Å–Ω–∏–º –Ω–∞–±–æ—Ä–æ–º —Ñ—Ä–µ–π–º—ñ–≤/–ø–æ–ª—ñ–≤. –ü—Ä–∏–∫–ª–∞–¥ ‚Äî `landowner`:
```python
LANDOWNER_COMPONENT = {
  "component_id": "landowner",
  "version": 1,
  "frames": [
    {
      "title": "–ü–æ–º—ñ—â–∏–∫/–ü–æ–º—ñ—â–∏—Ü—è",
      "fields": [
        {"id": "{mount}.person",  "type": "person", "label": "–û—Å–æ–±–∞"},
        {"id": "{mount}.place",   "type": "place",  "label": "–ú—ñ—Å—Ü–µ"},
        {"id": "{mount}.gender",  "type": "entry",  "options": ALL_GENDERS, "default": GENDER_UNKNOWN, "use_combobox": true},

        // –ü–æ–ª—è, —â–æ –∑–∞–ª–µ–∂–∞—Ç—å –≤—ñ–¥ —Å—Ç–∞—Ç—ñ
        {"id": "{mount}.original_name", "type": "entry", "options": man_given,  "show_when": {"var": "{mount}.gender", "in": [GENDER_MAN, GENDER_WOMAN]}},
        {"id": "{mount}.normalized_name","type": "entry", "options": man_given,  "show_when": {"var": "{mount}.gender", "in": [GENDER_MAN, GENDER_WOMAN]}},

        // ¬´–ü–æ—Ç–æ—á–Ω—ñ¬ª –ø—Ä—ñ–∑–≤–∏—â–∞ (–¥–ª—è M –∞–±–æ U)
        {"id": "{mount}.original_surname",   "type": "entry", "options": man_surnames, "show_when": {"var": "{mount}.gender", "in": [GENDER_MAN, GENDER_UNKNOWN]}},
        {"id": "{mount}.normalized_surname", "type": "entry", "options": man_surnames, "show_when": {"var": "{mount}.gender", "in": [GENDER_MAN, GENDER_UNKNOWN]}},

        // –ñ—ñ–Ω–æ—á—ñ –∫–µ–π—Å–∏: –¥—ñ–≤–æ—á–µ + —É —à–ª—é–±—ñ
        {"id": "{mount}.original_surname_maiden",   "type": "entry", "options": woman_surnames, "show_when": {"var": "{mount}.gender", "equals": GENDER_WOMAN}},
        {"id": "{mount}.normalized_surname_maiden", "type": "entry", "options": woman_surnames, "show_when": {"var": "{mount}.gender", "equals": GENDER_WOMAN}},
        {"id": "{mount}.original_surname_married",  "type": "entry", "options": woman_surnames, "show_when": {"var": "{mount}.gender", "equals": GENDER_WOMAN}},
        {"id": "{mount}.normalized_surname_married","type": "entry", "options": woman_surnames, "show_when": {"var": "{mount}.gender", "equals": GENDER_WOMAN}},

        // –°–ø—ñ–ª—å–Ω–∏–π —Å—Ç–∞–Ω —á–µ—Ä–µ–∑ state_key
        {"id": "{mount}.military_rank_man",    "state_key": "{mount}.military_rank", "type": "entry", "options": MAN_MILITARY_RANKS,    "show_when": {"var": "{mount}.gender", "equals": GENDER_MAN}},
        {"id": "{mount}.military_rank_woman",  "state_key": "{mount}.military_rank", "type": "entry", "options": WOMAN_MILITARY_RANKS,  "show_when": {"var": "{mount}.gender", "equals": GENDER_WOMAN}},
      ],
    },
  ],
}
```

> –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É –Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —à–∞–±–ª–æ–Ω—É `"{mount}.field"` ‚Äî –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –≤–∏ –∑–∞–¥–∞—î—Ç–µ —Ä–µ–∞–ª—å–Ω–∏–π —à–ª—è—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `groom_box.landowner`), —ñ –≤—Å—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ —Å—Ç–∞–Ω—É—Ç—å —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º–∏.

### 7.2. –§—Ä–∞–≥–º–µ–Ω—Ç (fragment)
–§—Ä–∞–≥–º–µ–Ω—Ç ‚Äî —Ü–µ ¬´–ª–æ–∫–∞–ª—å–Ω–∏–π¬ª –Ω–∞–±—ñ—Ä –ø–æ–ª—ñ–≤ (—ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ **–±–µ–∑** –ø—Ä–µ—Ñ—ñ–∫—Å—É). –ü—ñ–¥ —á–∞—Å –≤–∫–ª—é—á–µ–Ω–Ω—è —ó—Ö **–ø—Ä–∏–∫—Ä—É—á—É—î** –¥–æ `mount`:
```python
register_fragment("woman_subject", [
    { "id": "person", "type": "person",
      "labels": {"long": "–û—Å–æ–±–∞", "middle": "–û—Å–æ–±–∞", "short": "–û—Å–æ–±–∞"} },
    { "id": "place",  "type": "place",
      "labels": {"long": "–ú—ñ—Å—Ü–µ –ø—Ä–æ–∂–∏–≤–∞–Ω–Ω—è", "middle": "–ú—ñ—Å—Ü–µ –ø—Ä–æ–∂.", "short": "–ú—ñ—Å—Ü–µ"} },

    { "id": "original_name", "type": "entry", "options": woman_given,
      "labels": {"long": "–Ü–º'—è (–æ—Ä–∏–≥—ñ–Ω–∞–ª)", "middle": "–Ü–º'—è (–æ—Ä–∏–≥.)", "short": "–Ü–º'—è (–æ—Ä–∏–≥.)"} },
    { "id": "normalized_name", "type": "entry", "options": woman_given,
      "labels": {"long": "–Ü–º'—è (–Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–µ)","middle": "–Ü–º'—è (–Ω–æ—Ä–º–∞–ª—ñ–∑.)","short": "–Ü–º'—è (–Ω–æ—Ä–º.)"} },

    // ... —ñ–Ω—à—ñ –ø–æ–ª—è ...
])
```
–£ —Ñ—ñ–Ω–∞–ª—å–Ω–æ–º—É –≤–∏–≥–ª—è–¥—ñ (–ø—ñ—Å–ª—è `$fragment`) —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ —Å—Ç–∞–Ω—É—Ç—å –Ω–∞ –∫—à—Ç–∞–ª—Ç `bride_box.subject_person.person`, `...place`, `...original_name`, —Ç–æ—â–æ.


## 8) –î–∏–Ω–∞–º—ñ–∫–∞ GUI —ñ –∂–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª —Ñ–æ—Ä–º–∏

- **–í—ñ–¥–∫—Ä–∏—Ç—Ç—è/–æ–Ω–æ–≤–ª–µ–Ω–Ω—è**: –ø—Ä–∏ –∑–º—ñ–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å —É `UARecords.save_options()` –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è:
  1) `sync_label_mode_from_density()` ‚Äî –∑–º—ñ–Ω—é—î —Ä–µ–∂–∏–º –º—ñ—Ç–æ–∫ —ñ —Ä–æ–∑—Å–∏–ª–∞—î –ø–æ–¥—ñ—é –ø—ñ–¥–ø–∏—Å–Ω–∏–∫–∞–º;
  2) `_refresh_open_forms()` ‚Äî –∫–æ–∂–Ω–µ –≤—ñ–¥–∫—Ä–∏—Ç–µ –≤—ñ–∫–Ω–æ `BaseEditForm` –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `_on_refresh_options(None)` (–æ—á–∏—â–∞—î –∫–µ—à—ñ –æ–ø—Ü—ñ–π, –ø–µ—Ä–µ–≤—ñ–¥–∫—Ä–∏–≤–∞—î –≤—ñ–∫–Ω–æ –∑ –∞–∫—Ç—É–∞–ª—å–Ω–∏–º–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏).
- **–ñ–∏–≤–∏–π —Å–∏–Ω–∫** –ø–æ–ª—ñ–≤ ‚Üí `BaseEditForm._enable_live_sync()` —Å—Ç–∞–≤–∏—Ç—å —Å–∏–≥–Ω–∞–ª `changed` / `toggled` –Ω–∞ –≤—Å—ñ –∫–æ–Ω—Ç—Ä–æ–ª—ñ –¥–ª—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞–Ω—É.
- **–ó–±–∏—Ä–∞–Ω–Ω—è Gramps ID** ‚Üí –∫–Ω–æ–ø–∫–∞ ¬´–ö–æ–ø—ñ—é–≤–∞—Ç–∏ Gramps ID¬ª –æ–±—Ö–æ–¥–∏—Ç—å —É—Å—ñ –ø–æ–ª—è/—Å—Ç–∞–Ω —Ç–∞ —Ñ–æ—Ä–º—É—î —Å–ø–∏—Å–æ–∫ ID –¥–ª—è –±—É—Ñ–µ—Ä–∞ –æ–±–º—ñ–Ω—É.


## 9) –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤ UI (Settings)

–ü–∞—Ä–∞–º–µ—Ç—Ä–∏, —â–æ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ —Ñ–æ—Ä–º–∏:
- **–ö–æ–ª–æ–Ω–∫–∏** (–Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è/—Å–º–µ—Ä—Ç—å/—à–ª—é–±): 1‚Äì5 ‚Üí –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ —Ä–æ–∑–∫–ª–∞–¥–∫—É `order`, `show_when_cols_in`, `span_*`.
- **–°—Ç–∏–ª—å —Ñ–æ—Ä–º (density)**: `compact | normal | spacious` ‚Üí –∫–µ—Ä—É—î –≤—ñ–¥—Å—Ç—É–ø–∞–º–∏/—Å–ø–µ–π—Å–∏–Ω–≥–æ–º —ñ **—Ä–µ–∂–∏–º–æ–º –º—ñ—Ç–æ–∫** —á–µ—Ä–µ–∑ `sync_label_mode_from_density()`.
- **–ú–∞–∫—Å. –¥–æ–≤–∂–∏–Ω–∏**: —ñ–º–µ–Ω –æ—Å—ñ–± / –Ω–∞–∑–≤ –º—ñ—Å—Ü—å / —Ç–µ–∫—Å—Ç—É —Ü–∏—Ç–∞—Ç ‚Üí –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ —É—Å—ñ—á–µ–Ω–Ω—è/—à–∏—Ä–∏–Ω–∏ DnD —Ç–∞ –ø–æ–ª—ñ–≤ –∑ –ø—ñ–¥–∫–∞–∑–∫–∞–º–∏.

> –ü—ñ—Å–ª—è –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è ¬´–ó–±–µ—Ä–µ–≥—Ç–∏¬ª —É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö —É—Å–µ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –æ–¥—Ä–∞–∑—É: –≤—ñ–¥–∫—Ä–∏—Ç—ñ —Ñ–æ—Ä–º–∏ –ø–µ—Ä–µ–≤—ñ–¥–∫—Ä–∏–≤–∞—é—Ç—å—Å—è, –≤–∫–ª–∞–¥–∫–∏ —Ç–∞ –º—ñ—Ç–∫–∏ –æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è.


## 10) –ü—ñ–¥–∫–∞–∑–∫–∏ —ñ –∫—Ä–∞—â—ñ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–ó–∞–≤–∂–¥–∏** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `labels: {short|middle|long}` –¥–ª—è –ø–æ–ª—ñ–≤ **—Ç–∞** `titles: {short|middle|long}` –¥–ª—è –≤–∫–ª–∞–¥–æ–∫.  
2. –î–ª—è —à–∏—Ä–æ–∫–∏—Ö —Ä—è–¥–∫—ñ–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `span_rest: true` ‚Äî —Ü–µ –ª–µ–≥—à–µ, –Ω—ñ–∂ –≤—Ä—É—á–Ω—É —Ä–∞—Ö—É–≤–∞—Ç–∏ `span_pairs`.
3. –î–ª—è —É–º–æ–≤–Ω–∏—Ö –ø–æ–ª—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–π—Ç–µ—Å—è `show_when` –∑ `equals` –∞–±–æ `in` ‚Äî –∑—Ä—É—á–Ω–æ –¥–ª—è —Ä–æ–∑–≥–∞–ª—É–∂–µ–Ω—å –∑–∞ —Å—Ç–∞—Ç—Ç—é —á–∏ —Ç–∏–ø–æ–º –æ–±‚Äô—î–∫—Ç–∞.
4. –Ø–∫—â–æ —Ç—Ä–µ–±–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É–≤–∞—Ç–∏ –¥–µ–∫—ñ–ª—å–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª—ñ–≤ –≤ –æ–¥–∏–Ω –∫–ª—é—á —Å—Ç–∞–Ω—É ‚Äî –∑–∞—Å—Ç–æ—Å–æ–≤—É–π—Ç–µ `state_key`.
5. –î–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫—É –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö `columns` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∞–±–æ —Å–ª–æ–≤–Ω–∏–∫–æ–≤–∏–π `order`, –∞–±–æ –∫–æ–º–ø–∞–∫—Ç–Ω–∏–π —Ä—è–¥–∫–æ–≤–∏–π `"cN.oM"`.
6. –ù–µ –∑–º—ñ—à—É–π—Ç–µ —Å—Ç–∞—Ä—ñ –∫–ª—é—á—ñ –≤–∫–ª–∞–¥–æ–∫ (`"1","2"`) –∑ –Ω–æ–≤–∏–º–∏ ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **—Ç—ñ–ª—å–∫–∏** `short/middle/long`.


## 11) –°–∏—Å—Ç–µ–º–∞ –¥–æ–ø–æ–º–æ–≥–∏ (Help System)

### 11.1. –ö–Ω–æ–ø–∫–∏ –¥–æ–ø–æ–º–æ–≥–∏ –¥–ª—è –ø–æ–ª—ñ–≤

UARecords –Ω–∞–¥–∞—î –≤–±—É–¥–æ–≤–∞–Ω—É —Å–∏—Å—Ç–µ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ—ó –¥–æ–ø–æ–º–æ–≥–∏ –¥–ª—è –ø–æ–ª—ñ–≤ —Ñ–æ—Ä–º. –ë—É–¥—å-—è–∫–µ –ø–æ–ª–µ –º–æ–∂–µ –º–∞—Ç–∏ –∫–Ω–æ–ø–∫—É –¥–æ–ø–æ–º–æ–≥–∏ –∑ –¥–µ—Ç–∞–ª—å–Ω–∏–º –ø–æ—è—Å–Ω–µ–Ω–Ω—è–º.

#### –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –ø–æ–ª—è –∑ –¥–æ–ø–æ–º–æ–≥–æ—é
```jsonc
{
  "id": "bride_box.subject_person.original_name",
  "type": "entry",
  "label": "–Ü–º'—è (–æ—Ä–∏–≥—ñ–Ω–∞–ª)",
  "help": "–í–≤–µ–¥—ñ—Ç—å —ñ–º'—è –æ—Å–æ–±–∏ —Ç–∞–∫, —è–∫ –≤–æ–Ω–æ –∑–∞–ø–∏—Å–∞–Ω–æ –≤ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–º—É –¥–æ–∫—É–º–µ–Ω—Ç—ñ.\n\n**–ü—Ä–∞–≤–∏–ª–∞ –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è:**\n- –ó–±–µ—Ä—ñ–≥–∞–π—Ç–µ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–µ –Ω–∞–ø–∏—Å–∞–Ω–Ω—è\n- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∫–∏—Ä–∏–ª–∏—á–Ω–∏–π –∞–±–æ –ª–∞—Ç–∏–Ω—Å—å–∫–∏–π –∞–ª—Ñ–∞–≤—ñ—Ç\n- *–ü—Ä–∏–∫–ª–∞–¥*: –Ü–≤–∞–Ω, –ú–∞—Ä–∏—è, Johann",
  "options": ["–Ü–≤–∞–Ω", "–ü–µ—Ç—Ä–æ", "–ú–∞—Ä–∏—è"]
}
```

#### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ –∫–ª—é—á—ñ
- `"help"` ‚Äî –æ—Å–Ω–æ–≤–Ω–∏–π –∫–ª—é—á –¥–ª—è —Ç–µ–∫—Å—Ç—É –¥–æ–ø–æ–º–æ–≥–∏
- `"help_text"` ‚Äî –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π –∫–ª—é—á (–¥–ª—è –∑–≤–æ—Ä–æ—Ç–Ω–æ—ó —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ)

#### –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ Markdown
–¢–µ–∫—Å—Ç –¥–æ–ø–æ–º–æ–≥–∏ –ø—ñ–¥—Ç—Ä–∏–º—É—î —Å–ø—Ä–æ—â–µ–Ω–∏–π Markdown-—Å–∏–Ω—Ç–∞–∫—Å–∏—Å:
- `**–∂–∏—Ä–Ω–∏–π —Ç–µ–∫—Å—Ç**` ‚Üí <b>–∂–∏—Ä–Ω–∏–π —Ç–µ–∫—Å—Ç</b>
- `*–∫—É—Ä—Å–∏–≤*` ‚Üí <i>–∫—É—Ä—Å–∏–≤</i>
- `__–ø—ñ–¥–∫—Ä–µ—Å–ª–µ–Ω–Ω—è__` ‚Üí <u>–ø—ñ–¥–∫—Ä–µ—Å–ª–µ–Ω–Ω—è</u>
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –ø–µ—Ä–µ–Ω–æ—Å —Ä—è–¥–∫—ñ–≤

### 11.2. –í—ñ–∑—É–∞–ª—å–Ω—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

#### –ö–Ω–æ–ø–∫–∞ –¥–æ–ø–æ–º–æ–≥–∏
- **–Ü–∫–æ–Ω–∫–∞**: PNG-—Ñ–∞–π–ª `ui/assets/help.png`
- **–†–æ–∑–º—ñ—Ä**: 60% –≤—ñ–¥ –≤–∏—Å–æ—Ç–∏ —Ä—è–¥–∫–∞ –ø–æ–ª—è (–º—ñ–Ω. 16px, –º–∞–∫—Å. 48px)
- **–ü–æ–∑–∏—Ü—ñ—è**: –ü—Ä–∞–≤–æ—Ä—É—á –≤—ñ–¥ –ø–æ–ª—è –∑ –≤—ñ–¥—Å—Ç—É–ø–æ–º 4px
- **–°—Ç–∏–ª—å**: –ë–µ–∑ —Ä–∞–º–∫–∏, –±–µ–∑ —Ñ–æ–∫—É—Å—É –ø—Ä–∏ –∫–ª—ñ–∫—É
- **–ü—ñ–¥–∫–∞–∑–∫–∞**: "Help"

#### –î—ñ–∞–ª–æ–≥ –¥–æ–ø–æ–º–æ–≥–∏
- **–¢–∏–ø**: –ú–æ–¥–∞–ª—å–Ω–∏–π –¥—ñ–∞–ª–æ–≥
- **–†–æ–∑–º—ñ—Ä**: 400√ó300 –ø—ñ–∫—Å–µ–ª—ñ–≤ (–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –ø—ñ–¥—ñ–≥–Ω–∞–Ω–Ω—è–º –∫–æ–Ω—Ç–µ–Ω—Ç—É)
- **–ó–∞–≥–æ–ª–æ–≤–æ–∫**: –ë–µ—Ä–µ—Ç—å—Å—è –∑ –º—ñ—Ç–∫–∏ –ø–æ–ª—è –∞–±–æ ID –ø–æ–ª—è
- **–ö–æ–Ω—Ç–µ–Ω—Ç**: –ü—Ä–æ–∫—Ä—É—á—É–≤–∞–Ω–∏–π —Ç–µ–∫—Å—Ç –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é —Ä–æ–∑–º—ñ—Ç–∫–∏
- **–ó–∞–∫—Ä–∏—Ç—Ç—è**: –ö–Ω–æ–ø–∫–∞ "OK" –∞–±–æ –∫–ª—ñ–∫ –ø–æ–∑–∞ –¥—ñ–∞–ª–æ–≥–æ–º

### 11.3. –¢–µ—Ö–Ω—ñ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è

#### –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫–Ω–æ–ø–∫–∏
–ö–Ω–æ–ø–∫–∞ –¥–æ–ø–æ–º–æ–≥–∏ –¥–æ–¥–∞—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —á–µ—Ä–µ–∑ `FieldRenderer._attach_help()`:

```python
def _attach_help(self, widget: Gtk.Widget, field: Dict[str, str], label_text: str) -> Gtk.Widget:
    help_text = field.get("help") or field.get("help_text") or ""
    if not isinstance(help_text, str) or not help_text.strip():
        return widget  # –ù–µ–º–∞—î —Ç–µ–∫—Å—Ç—É –¥–æ–ø–æ–º–æ–≥–∏ - –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –ø–æ–ª–µ —è–∫ —î
        
    # –°—Ç–≤–æ—Ä—é—î–º–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: –ø–æ–ª–µ + –∫–Ω–æ–ø–∫–∞ –¥–æ–ø–æ–º–æ–≥–∏
    box = Gtk.Box(orientation=Gtk.Orientation.HORIZONTAL, spacing=0)
    # ... –∫–æ–¥ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–Ω–æ–ø–∫–∏ ...
```

#### –û–±—Ä–æ–±–∫–∞ —Ä–æ–∑–º—ñ—Ç–∫–∏
Markdown-—Ä–æ–∑–º—ñ—Ç–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç—É—î—Ç—å—Å—è –≤ Pango markup —á–µ—Ä–µ–∑ `_render_help_markup()`:

```python
def _render_help_markup(self, text: str) -> str:
    s = GLib.markup_escape_text(text)  # –ï–∫—Ä–∞–Ω—É–≤–∞–Ω–Ω—è HTML
    s = re.sub(r"\*\*(.+?)\*\*", r"<b>\1</b>", s)  # **–∂–∏—Ä–Ω–∏–π**
    s = re.sub(r"\*(.+?)\*", r"<i>\1</i>", s)      # *–∫—É—Ä—Å–∏–≤*  
    s = re.sub(r"__(.+?)__", r"<u>\1</u>", s)      # __–ø—ñ–¥–∫—Ä–µ—Å–ª–µ–Ω–Ω—è__
    return s
```

### 11.4. –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

#### –ë–∞–∑–æ–≤–∞ –¥–æ–ø–æ–º–æ–≥–∞
```jsonc
{
  "id": "common_box.citation",
  "type": "citation", 
  "label": "–¶–∏—Ç–∞—Ç–∞",
  "help": "–û–±–µ—Ä—ñ—Ç—å –∞–±–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å —Ü–∏—Ç–∞—Ç—É –∑ –¥–∂–µ—Ä–µ–ª–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞"
}
```

#### –†–æ–∑—à–∏—Ä–µ–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞ –∑ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è–º
```jsonc
{
  "id": "bride_box.subject_person.military_rank",
  "type": "entry",
  "label": "–í—ñ–π—Å—å–∫–æ–≤–∏–π —á–∏–Ω",
  "help": "–í–∫–∞–∂—ñ—Ç—å –≤—ñ–π—Å—å–∫–æ–≤–∏–π —á–∏–Ω –æ—Å–æ–±–∏ –∑–≥—ñ–¥–Ω–æ –∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–º.\n\n**–ß–æ–ª–æ–≤—ñ—á—ñ —á–∏–Ω–∏:**\n- –†—è–¥–æ–≤–∏–π, –ö–∞–ø—Ä–∞–ª, –°–µ—Ä–∂–∞–Ω—Ç\n- –ü—Ä–∞–ø–æ—Ä—â–∏–∫, –ü–æ—Ä—É—á–∏–∫, –®—Ç–∞–±—Å-–∫–∞–ø—ñ—Ç–∞–Ω\n- –ö–∞–ø—ñ—Ç–∞–Ω, –ú–∞–π–æ—Ä, –ü—ñ–¥–ø–æ–ª–∫–æ–≤–Ω–∏–∫\n\n**–ñ—ñ–Ω–æ—á—ñ —á–∏–Ω–∏:**\n- –°–∞–Ω—ñ—Ç–∞—Ä–∫–∞, –ú–µ–¥—Å–µ—Å—Ç—Ä–∞\n- *–ü—Ä–∏–º—ñ—Ç–∫–∞*: –∂—ñ–Ω–æ—á—ñ –≤—ñ–π—Å—å–∫–æ–≤—ñ —á–∏–Ω–∏ —Ä—ñ–¥–∫–æ –∑—É—Å—Ç—Ä—ñ—á–∞—é—Ç—å—Å—è –≤ —Ü–∏–≤—ñ–ª—å–Ω–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö",
  "options": ["–†—è–¥–æ–≤–∏–π", "–ö–∞–ø—Ä–∞–ª", "–°–µ—Ä–∂–∞–Ω—Ç", "–ü—Ä–∞–ø–æ—Ä—â–∏–∫"]
}
```

#### –î–æ–ø–æ–º–æ–≥–∞ –¥–ª—è DnD-–ø–æ–ª—ñ–≤
```jsonc
{
  "id": "groom_box.subject_person.person",
  "type": "person",
  "label": "–û—Å–æ–±–∞",
  "help": "**–ü–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å –æ—Å–æ–±—É –∑ –¥–µ—Ä–µ–≤–∞ Gramps –∞–±–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤—É.**\n\n–Ø–∫—â–æ –æ—Å–æ–±–∞ –Ω–µ —ñ—Å–Ω—É—î –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö:\n1. –ó–∞–ª–∏—à—Ç–µ –ø–æ–ª–µ –ø–æ—Ä–æ–∂–Ω—ñ–º\n2. –ó–∞–ø–æ–≤–Ω—ñ—Ç—å —ñ–Ω—à—ñ –ø–æ–ª—è –∑ —ñ–º–µ–Ω–µ–º —Ç–∞ –ø—Ä—ñ–∑–≤–∏—â–µ–º\n3. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç—å –Ω–æ–≤—É –æ—Å–æ–±—É –ø—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ\n\n*–°–∏–º–≤–æ–ª ‚à∑ –¥–æ–∑–≤–æ–ª—è—î –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞—Ç–∏ –ø–æ–ª–µ*"
}
```

### 11.5. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è —Ç–∞ –ø—Ä–∞–≤–∏–ª–∞

#### –£–º–æ–≤–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞
–î–æ–ø–æ–º–æ–≥–∞ –º–æ–∂–µ –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏—Å—è —Ç—ñ–ª—å–∫–∏ –¥–ª—è –ø–µ–≤–Ω–∏—Ö —É–º–æ–≤:
```jsonc
{
  "id": "landowner.military_rank_woman",
  "type": "entry", 
  "help": "–ñ—ñ–Ω–æ—á—ñ –≤—ñ–π—Å—å–∫–æ–≤—ñ —á–∏–Ω–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏—Å—è —Ä—ñ–¥–∫–æ. **–ü—Ä–∏–∫–ª–∞–¥–∏**: –°–∞–Ω—ñ—Ç–∞—Ä–∫–∞, –ú–µ–¥—Å–µ—Å—Ç—Ä–∞, –¢–µ–ª–µ—Ñ–æ–Ω—ñ—Å—Ç–∫–∞",
  "show_when": {"var": "landowner.gender", "equals": "–ñ—ñ–Ω–∫–∞"}
}
```

#### –£—Å–ø–∞–¥–∫—É–≤–∞–Ω–Ω—è –∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤/—Ñ—Ä–∞–≥–º–µ–Ω—Ç—ñ–≤  
–ö–Ω–æ–ø–∫–∏ –¥–æ–ø–æ–º–æ–≥–∏ –ø—Ä–∞—Ü—é—é—Ç—å –∑ `$include` —Ç–∞ `$fragment`:
```jsonc
{
  "$include": {
    "component": "witness",
    "mount": "groom_box.witness_1", 
    "title": "–°–≤—ñ–¥–æ–∫ –Ω–∞—Ä–µ—á–µ–Ω–æ–≥–æ"
  }
}
```
–í—Å—ñ –ø–æ–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ `witness` –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å —Å–≤—ñ–π —Ç–µ–∫—Å—Ç –¥–æ–ø–æ–º–æ–≥–∏.

### 11.6. –†–æ–∑—Ä–æ–±–∫–∞ —Ç–∞ –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è

#### –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö –∫–Ω–æ–ø–æ–∫ –¥–æ–ø–æ–º–æ–≥–∏
1. –î–æ–¥–∞–π—Ç–µ –∫–ª—é—á `"help"` –¥–æ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –ø–æ–ª—è
2. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ Markdown –¥–ª—è —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è
3. –¢–µ—Å—Ç—É–π—Ç–µ –¥–æ–≤–≥—ñ —Ç–µ–∫—Å—Ç–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –∫–æ—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è

#### –í—ñ–¥—Å—É—Ç–Ω—è —ñ–∫–æ–Ω–∫–∞
–Ø–∫—â–æ —Ñ–∞–π–ª `ui/assets/help.png` –≤—ñ–¥—Å—É—Ç–Ω—ñ–π, —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ –ø–æ–º–∏–ª–∫–∏. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —Ñ–∞–π–ª —ñ—Å–Ω—É—î —ñ –¥–æ—Å—Ç—É–ø–Ω–∏–π –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è.

#### CSS-—Å—Ç–∏–ª—ñ–∑–∞—Ü—ñ—è
–ö–Ω–æ–ø–∫–∞ –¥–æ–ø–æ–º–æ–≥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î CSS-–∫–ª–∞—Å `help-btn` –¥–ª—è —Å—Ç–∏–ª—ñ–∑–∞—Ü—ñ—ó. CSS –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î—Ç—å—Å—è –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ.

## 12) –î–æ–≤—ñ–¥–Ω–∏–∫ –∫–ª—é—á—ñ–≤ (—à–≤–∏–¥–∫–∞ —à–ø–∞—Ä–≥–∞–ª–∫–∞)

### –ù–∞ —Ä—ñ–≤–Ω—ñ —Ñ–æ—Ä–º–∏
- `id`, `title`, `list_label`, `type`, `columns?`
- `tabs`: —Å–ø–∏—Å–æ–∫ –≤–∫–ª–∞–¥–æ–∫

### –ù–∞ —Ä—ñ–≤–Ω—ñ –≤–∫–ª–∞–¥–∫–∏
- `id`, `titles: {short|middle|long|default}`, `frames`

### –ù–∞ —Ä—ñ–≤–Ω—ñ —Ñ—Ä–µ–π–º–∞
- `title`, `prefix?`, `background_color?`, `fields`

### –ü–æ–ª–µ
- –û–±–æ–≤'—è–∑–∫–æ–≤–æ: `id`, `type`
- –¢–µ–∫—Å—Ç: `label?`, `labels?{short|middle|long|default}`, `tooltip?`
- **–î–æ–ø–æ–º–æ–≥–∞**: `help?`, `help_text?` ‚Äî —Ç–µ–∫—Å—Ç –¥–æ–ø–æ–º–æ–≥–∏ –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é Markdown
- Value: `default?`, `options?`, `use_combobox?`
- –ú–∞–∫–µ—Ç: `order?`, `span_rest?`, `span_pairs?`, `show_when_cols_in?`
- –£–º–æ–≤–Ω—ñ—Å—Ç—å: `show_when? { var, equals | in }`
- –°—Ç–∞–Ω: `state_key?`
- Spacer: `row_height?`

### –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ —Ç–∏–ø–∏
- `entry`, `person`, `place`, `citation`, `check`/`checkbox`, `spacer`


---

–Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ ¬´–ø—ñ–¥ –∫–ª—é—á¬ª –ø—ñ–¥ –≤–∞—à –ø—Ä–æ—î–∫—Ç ‚Äî –¥–æ–¥–∞–π—Ç–µ —Å–≤—ñ–π –∫–æ–Ω—Ñ—ñ–≥ —É `FORM`, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `$include`/`$fragment` —ñ –¥–æ—Ç—Ä–∏–º—É–π—Ç–µ—Å—è —Ü–∏—Ö –ø—Ä–∞–≤–∏–ª. –°–∏—Å—Ç–µ–º–∞ —Ä–µ–Ω–¥–µ—Ä—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—ñ–¥–ª–∞—à—Ç—É—î –º–∞–∫–µ—Ç —Ç–∞ —Ç–µ–∫—Å—Ç–∏ –ø—ñ–¥ –æ–±—Ä–∞–Ω–∏–π —Å—Ç–∏–ª—å —ñ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ–ª–æ–Ω–æ–∫.
